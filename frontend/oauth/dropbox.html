<html>
<head>
<script>
var params = window.location.hash.substr(1);
var q = parseQueryString(params);

if (window.opener.OAuthCallback) {
  window.opener.OAuthCallback({
      "origin" : "dropbox",
      "token" : q.access_token,
      "type" : q.token_type,
      "uid" : q.uid,
      "state" : q.state
  });
  window.close();
} else {
    alert(JSON.stringify(q));
}

function parseQueryString(string) {
	var queryString = {};
    string.replace(
            new RegExp("([^?=&]+)(=([^&]*))?", "g"),
            function($0, $1, $2, $3) { queryString[$1] = $3; }
    );

    return queryString;
}
</script>
</head>
<body>

</body>
<html>
