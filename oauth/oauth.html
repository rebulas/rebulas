<html>
<head></head>
<body>
<p id="message" align="center"></p>

<script>
var params = window.location.href.substr(window.location.origin.length);
var q = parseQueryString(params);

if (window.opener.OAuthCallback) {
  if (q.api_type === 'onedrive') {
    window.opener.OAuthCallback(q);
  }
  window.close();
} else {
	document.getElementById("message").innerHTML = "Your access token is " + q.access_token;
}

function parseQueryString(string) {
	var queryString = {};
    string.replace(
            new RegExp("([^?=&]+)(=([^&]*))?", "g"),
            function($0, $1, $2, $3) { queryString[$1] = $3; }
    );

    return queryString;
}
</script>
</body>
<html>
